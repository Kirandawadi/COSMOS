{% extends "layouts/base.html" %}
{% load static i18n %}
{% block title %}
    {{ collection.name }} Candidate URLs
{% endblock title %}
{% block stylesheets %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'css/candidate_url_list.css' %}" />
{% endblock stylesheets %}
{% block javascripts %}
    {{ block.super }}
    <script defer src="{% static 'js/candidate_url_list.js' %}"></script>
    {% comment %}
    <script src="//code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
    {% endcomment %}
{% endblock javascripts %}
{% block content %}
    <table class="table">
        <thead>
            <tr>
                <th scope="col" class="text-center">
                    <strong>Visited</strong>
                </th>
                <th scope="col" class="text-center">
                    <strong>URL</strong>
                </th>
                <th scope="col" class="text-center">
                    <strong>Scraped Title</strong>
                </th>
            </tr>
        </thead>
        <tbody>
            {% for candidate_url in candidate_urls %}
                <tr>
                    <td class="text-center">
                        {% comment %} <i class="material-icons" style="color: green;">done</i> {% endcomment %}
                    </td>
                    <td>
                        <a href="{{ candidate_url.url }}" target="_blank">{{ candidate_url.url }}</a>
                    </td>
                    <td>
                        <input class="form-control new-title"
                               type="text"
                               title="{{ candidate_url.scraped_title }}"
                               value="{{ candidate_url.scraped_title }}">
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    {% comment %}
    {% for candidate_url in candidate_urls %}
        <div class="row">
            <div class="col-8">
                <form>
                    <a href="{{ candidate_url.url }}" target="_blank">{{ candidate_url.url }}</a>
                </form>
            </div>
            <div class="col">
                <input class="form-control new-title" type="text" title="{{ candidate_url.scraped_title }}" value="{{ candidate_url.scraped_title }}">
            </div>
        </div>
    {% empty %}
        <p>No candidate urls found</p>
    {% endfor %}
    {% endcomment %}
{% endblock content %}
{% block sidebar %}
    <div class="sidebar"
         data-color="purple"
         data-background-color="white"
         data-image="{% static 'images/sidebar-1.jpg' %}">
        <div class="logo">
            <a rel="noopener noreferrer"
               href="{% url 'sde_collections:list' %}"
               class="simple-text logo-normal">SDE Indexing Helper</a>
        </div>
        <div class="sidebar-wrapper">
            <ul class="nav">
                {% if request.user.is_authenticated %}
                    <div class="col">
                        <h4>
                            <input type="checkbox" value="" id="excluded_bool">
                            Hide Excluded
                        </h4>
                    </div>
                    <hr>
                    <div class="col">
                        <h4>
                            <strong>Exclude Patterns</strong>
                            <button id="add_exclude_pattern" class="btn btn-primary btn-sm">+</button>
                        </h4>
                        <form id="exclude_patterns">
                            {% csrf_token %}
                            {% for pattern in collection.exclude_patterns.all %}
                                <div class="row pattern_row">
                                    <div class="col-8">
                                        <input class="form-control"
                                               value="{{ pattern }}"
                                               title="{{ pattern }}"
                                               disabled
                                               style="direction: rtl" />
                                    </div>
                                    <div class="col">
                                        <button type="button"
                                                class="btn btn-danger btn-sm delete_input"
                                                hx-delete="/api/exclude-patterns/{{ pattern.id }}/"
                                                hx-confirm="Are you sure you wish to delete this pattern?">x</button>
                                    </div>
                                </div>
                            {% endfor %}
                        </form>
                    </div>
                    <hr>
                    <div class="col">
                        <h4>
                            <strong>Title Patterns</strong>
                            <button id="add_exclude_pattern" class="btn btn-sm btn-primary">+</button>
                        </h4>
                    </div>
                {% else %}
                {% endif %}
            </ul>
        </div>
    </div>
{% endblock sidebar %}
